<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Raheem AI | Construction Compliance Intelligence</title>

  <style>
    :root{
      --bg0:#050913;
      --bg1:#071225;
      --bg2:#0a1a33;
      --surface: rgba(255,255,255,.06);
      --surface2: rgba(255,255,255,.08);
      --border: rgba(255,255,255,.14);
      --text:#eaf2ff;
      --muted: rgba(234,242,255,.82);
      --muted2: rgba(234,242,255,.62);
      --p1:#2563eb;
      --p2:#38bdf8;
      --p3:#22d3ee;
      --ok:#22c55e;
      --warn:#f59e0b;
      --shadow: 0 18px 42px rgba(0,0,0,.52);
      --shadow2: 0 12px 26px rgba(0,0,0,.40);
      --r:18px;
      --r2:14px;
      --font: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, Arial, sans-serif;
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }

    body{
      margin:0;
      font-family: var(--font);
      color: var(--text);
      background:
        radial-gradient(1100px 520px at 12% 10%, rgba(56,189,248,.18) 0%, rgba(56,189,248,0) 60%),
        radial-gradient(1000px 520px at 88% 16%, rgba(37,99,235,.22) 0%, rgba(37,99,235,0) 58%),
        radial-gradient(900px 520px at 55% 100%, rgba(34,211,238,.12) 0%, rgba(34,211,238,0) 60%),
        linear-gradient(180deg, var(--bg0) 0%, var(--bg1) 30%, var(--bg2) 100%);
      overflow-x:hidden;
    }

    body::before{
      content:"";
      position: fixed;
      inset:0;
      pointer-events:none;
      opacity:.10;
      background-image:
        linear-gradient(to right, rgba(56,189,248,.15) 1px, transparent 1px),
        linear-gradient(to bottom, rgba(56,189,248,.12) 1px, transparent 1px);
      background-size: 64px 64px;
      mask-image: radial-gradient(circle at 30% 10%, rgba(0,0,0,1), rgba(0,0,0,0) 65%);
      animation: gridDrift 18s linear infinite;
      z-index: 0;
    }

    @keyframes gridDrift{
      0%{ background-position: 0 0, 0 0; }
      100%{ background-position: 140px 70px, 70px 140px; }
    }

    body::after{
      content:"";
      position: fixed;
      inset:-40vh -40vw;
      pointer-events:none;
      background:
        radial-gradient(closest-side at 18% 30%, rgba(56,189,248,.12), rgba(56,189,248,0) 60%),
        radial-gradient(closest-side at 82% 18%, rgba(37,99,235,.14), rgba(37,99,235,0) 62%),
        radial-gradient(closest-side at 55% 86%, rgba(34,211,238,.10), rgba(34,211,238,0) 60%);
      filter: blur(10px);
      opacity: .90;
      animation: auroraDrift 26s ease-in-out infinite;
      z-index: 0;
    }

    @keyframes auroraDrift{
      0%,100%{ transform: translate3d(0,0,0) scale(1); }
      50%{ transform: translate3d(3vw,-2vh,0) scale(1.03); }
    }

    .app{
      display:grid;
      grid-template-columns: 340px 1fr;
      min-height:100vh;
      position: relative;
      z-index: 1;
    }
    @media (max-width: 980px){
      .app{ grid-template-columns: 1fr; }
      .sidebar{
        position: sticky; top:0; z-index:50;
        border-radius: 0 0 var(--r) var(--r);
      }
    }

    .sidebar{
      background: rgba(6,12,26,.84);
      border-right: 1px solid rgba(255,255,255,.08);
      backdrop-filter: blur(12px);
      padding: 18px;
      position: relative;
      overflow:hidden;
      z-index: 1;
    }
    .sidebar::after{
      content:"";
      position:absolute;
      inset:-140px -140px auto auto;
      width: 320px; height: 320px;
      background: radial-gradient(circle, rgba(56,189,248,.22), rgba(56,189,248,0) 65%);
      pointer-events:none;
      transform: translate(40px,-40px);
    }

    .brand{
      display:flex; align-items:center; gap:12px;
      padding: 10px 10px 14px;
      border-bottom: 1px solid rgba(255,255,255,.08);
      margin-bottom: 14px;
      position:relative;
      z-index:1;
    }

    .logo{
      width:46px; height:46px;
      border-radius: 16px;
      display:flex; align-items:center; justify-content:center;
      border: 1px solid rgba(255,255,255,.18);
      background:
        radial-gradient(circle at 30% 30%, rgba(255,255,255,.20), rgba(255,255,255,0) 60%),
        linear-gradient(135deg, rgba(56,189,248,.95), rgba(37,99,235,.95));
      box-shadow: 0 18px 40px rgba(56,189,248,.18);
      overflow:hidden;
      user-select:none;
      position:relative;
      animation: logoGlow 3.8s ease-in-out infinite;
    }
    @keyframes logoGlow{
      0%,100%{ box-shadow: 0 18px 40px rgba(56,189,248,.18); }
      50%{ box-shadow: 0 22px 56px rgba(34,211,238,.22); }
    }
    .logo svg{ width:34px; height:34px; }
    .logo::after{
      content:"";
      position:absolute;
      inset:-90px auto auto -90px;
      width:200px; height:200px;
      background: radial-gradient(circle, rgba(34,211,238,.24), rgba(34,211,238,0) 62%);
      transform: rotate(16deg);
      pointer-events:none;
    }

    .brand h1{
      margin:0;
      font-size: 16px;
      letter-spacing: .2px;
      line-height:1.1;
      font-weight: 800;
    }
    .brand p{
      margin:4px 0 0;
      font-size: 12px;
      color: var(--muted);
    }
    .brand .tagline{
      font-size: 11px;
      color: var(--muted2);
      margin-top: 4px;
      line-height: 1.25;
    }

    .pill{
      font-size: 11px;
      padding: 4px 9px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.06);
      color: rgba(234,242,255,.70);
      user-select:none;
      white-space: nowrap;
    }
    .pill.live{
      border-color: rgba(34,197,94,.40);
      color: #ccffe0;
      background: rgba(34,197,94,.12);
    }
    .pill.brand{
      border-color: rgba(34,211,238,.40);
      color: #d7fbff;
      background: rgba(34,211,238,.10);
    }

    .doc-panel{
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.07);
      border-radius: var(--r2);
      padding: 12px;
      margin-bottom: 14px;
      position:relative;
      z-index:1;
    }
    .doc-head{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap: 10px;
      margin-bottom: 10px;
    }
    .doc-title{
      margin:0;
      font-size: 12px;
      letter-spacing: .9px;
      text-transform: uppercase;
      color: rgba(234,242,255,.86);
      font-weight: 900;
    }
    .doc-sub{
      margin:6px 0 0;
      font-size: 12px;
      color: rgba(234,242,255,.64);
      line-height: 1.35;
    }

    .field{ margin-top: 10px; }
    .label{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
      font-size: 11px;
      color: rgba(234,242,255,.80);
      margin-bottom: 6px;
      letter-spacing: .2px;
      font-weight: 900;
    }

    .input, select{
      width:100%;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,.18);
      background: rgba(3,7,16,.86);
      color: var(--text);
      padding: 11px 12px;
      font-size: 13px;
      font-weight: 780;
      outline:none;
    }
    select option{
      background: #0b1428;
      color: #eaf2ff;
    }
    .input:focus, select:focus{
      outline: 3px solid rgba(56,189,248,.22);
      outline-offset: 2px;
    }

    .doc-badge-row{
      display:flex; gap:8px; flex-wrap:wrap;
      margin-top: 10px;
      align-items:center;
    }
    .mini{
      font-size: 11px;
      color: rgba(234,242,255,.74);
      background: rgba(255,255,255,.06);
      border: 1px solid rgba(255,255,255,.12);
      padding: 6px 10px;
      border-radius: 999px;
      display:inline-flex;
      gap:8px;
      align-items:center;
    }
    .mini .dot{
      width:8px; height:8px; border-radius:50%;
      background: rgba(234,242,255,.35);
    }
    .mini.ok .dot{
      background: var(--ok);
      box-shadow: 0 0 0 4px rgba(34,197,94,.12);
    }
    .mini.warn .dot{
      background: #f59e0b;
      box-shadow: 0 0 0 4px rgba(245,158,11,.12);
    }

    .history-panel{
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.06);
      border-radius: var(--r2);
      padding: 12px;
      margin-top: 14px;
      position:relative;
      z-index:1;
    }
    .history-head{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
      margin-bottom: 10px;
    }
    .history-title{
      font-size: 12px;
      letter-spacing: .9px;
      text-transform: uppercase;
      color: rgba(234,242,255,.86);
      font-weight: 950;
      margin:0;
    }
    .history-actions{
      display:flex;
      gap: 8px;
      align-items:center;
    }
    .btn-mini{
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      color: var(--text);
      padding: 7px 9px;
      border-radius: 12px;
      font-weight: 950;
      font-size: 12px;
      cursor:pointer;
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
    }
    .btn-mini:hover{
      transform: translateY(-1px);
      background: rgba(255,255,255,.10);
      border-color: rgba(56,189,248,.22);
    }

    .history-list{
      display:flex;
      flex-direction:column;
      gap: 8px;
      max-height: 240px;
      overflow:auto;
      padding-right: 4px;
    }
    .history-item{
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(3,7,16,.62);
      border-radius: 14px;
      padding: 10px;
      cursor:pointer;
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
    }
    .history-item:hover{
      transform: translateY(-1px);
      background: rgba(255,255,255,.08);
      border-color: rgba(56,189,248,.22);
    }
    .history-item.active{
      border-color: rgba(34,211,238,.38);
      background: rgba(255,255,255,.10);
    }
    .history-row{
      display:flex;
      justify-content:space-between;
      align-items:flex-start;
      gap: 10px;
    }
    .history-name{
      font-weight: 950;
      font-size: 12px;
      color: rgba(234,242,255,.90);
      line-height: 1.25;
    }
    .history-meta{
      font-size: 11px;
      color: rgba(234,242,255,.60);
      white-space: nowrap;
    }
    .history-preview{
      margin-top: 6px;
      font-size: 12px;
      color: rgba(234,242,255,.70);
      line-height: 1.35;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }
    .history-controls{
      margin-top: 10px;
      display:flex;
      gap: 8px;
    }
    .history-btn{
      flex:1;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.06);
      color: rgba(234,242,255,.86);
      padding: 8px 10px;
      border-radius: 12px;
      font-weight: 950;
      font-size: 12px;
      cursor:pointer;
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
    }
    .history-btn:hover{
      transform: translateY(-1px);
      background: rgba(255,255,255,.10);
      border-color: rgba(56,189,248,.22);
    }

    .nav{
      display:flex;
      flex-direction:column;
      gap: 8px;
      margin-top: 10px;
      position:relative;
      z-index:1;
    }
    .nav button{
      width:100%;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.06);
      color: var(--text);
      border-radius: 14px;
      padding: 11px 12px;
      text-align:left;
      cursor:pointer;
      font-weight: 900;
      font-size: 13px;
      display:flex; align-items:center; justify-content:space-between;
      transition: transform .12s ease, background .12s ease, border-color .12s ease, box-shadow .12s ease;
    }
    .nav button:hover{
      transform: translateY(-1px);
      background: rgba(255,255,255,.09);
      border-color: rgba(56,189,248,.24);
      box-shadow: 0 10px 26px rgba(0,0,0,.22);
    }
    .nav button.active{
      border-color: rgba(56,189,248,.40);
      background: rgba(255,255,255,.10);
    }

    .content{ padding: 18px 22px 40px; position: relative; z-index: 1; }

    .topbar{
      display:flex;
      align-items:stretch;
      justify-content:space-between;
      gap: 14px;
      margin-bottom: 14px;
    }
    @media (max-width: 980px){
      .topbar{ flex-direction: column; }
      .auth-top{ width: 100% !important; min-width: unset !important; }
    }

    .hero{
      flex:1;
      border: 1px solid rgba(255,255,255,.12);
      background: linear-gradient(180deg, rgba(255,255,255,.075), rgba(255,255,255,.045));
      border-radius: var(--r);
      padding: 18px;
      box-shadow: 0 1px 0 rgba(255,255,255,.02);
      position:relative;
      overflow:hidden;
    }
    .hero::after{
      content:"";
      position:absolute;
      inset:auto -120px -120px auto;
      width: 340px; height: 340px;
      background: radial-gradient(circle, rgba(37,99,235,.22), rgba(37,99,235,0) 65%);
      pointer-events:none;
      animation: sweep 8s ease-in-out infinite;
    }
    @keyframes sweep{
      0%,100%{ transform: translate(0,0); opacity:.95; }
      50%{ transform: translate(-18px,-10px); opacity:.78; }
    }

    .hero h2{
      margin:0;
      font-size: 22px;
      letter-spacing:.1px;
      display:flex;
      align-items:center;
      gap: 10px;
      font-weight: 900;
    }
    .hero p{
      margin: 10px 0 0;
      color: rgba(234,242,255,.82);
      font-size: 13px;
      max-width: 980px;
      line-height: 1.55;
    }
    .quote{
      margin-top: 12px;
      padding: 10px 12px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(3,7,16,.55);
      border-radius: 14px;
      color: rgba(234,242,255,.74);
      font-size: 12px;
      font-style: italic;
      max-width: 980px;
    }

    .auth-top{
      width: 250px;
      min-width: 230px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.06);
      border-radius: var(--r);
      padding: 14px;
      box-shadow: 0 1px 0 rgba(255,255,255,.02);
      position:relative;
      overflow:hidden;
    }
    .auth-top::after{
      content:"";
      position:absolute;
      inset:-130px auto auto -130px;
      width: 320px; height: 320px;
      background: radial-gradient(circle, rgba(56,189,248,.16), rgba(56,189,248,0) 65%);
      pointer-events:none;
    }
    .auth-title{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
      margin-bottom: 10px;
      position:relative;
      z-index:1;
    }
    .auth-title span{
      font-size: 12px;
      color: rgba(234,242,255,.84);
      font-weight: 950;
      letter-spacing: .2px;
    }

    .btn{
      border: 1px solid rgba(255,255,255,.16);
      background: rgba(255,255,255,.07);
      color: var(--text);
      padding: 10px 12px;
      border-radius: 14px;
      font-weight: 950;
      font-size: 13px;
      cursor:pointer;
      transition: transform .12s ease, background .12s ease, border-color .12s ease, box-shadow .12s ease;
      display:inline-flex;
      align-items:center;
      gap: 8px;
      position:relative;
      z-index:1;
    }
    .btn:hover{
      transform: translateY(-1px);
      background: rgba(255,255,255,.10);
      border-color: rgba(56,189,248,.24);
      box-shadow: 0 10px 24px rgba(0,0,0,.22);
    }

    .btn.primary{
      background: linear-gradient(135deg, rgba(34,211,238,.96), rgba(37,99,235,.96));
      border-color: rgba(56,189,248,.38);
    }
    .btn.small{
      padding: 9px 10px;
      font-size: 12px;
      border-radius: 12px;
      width: 100%;
      justify-content:center;
    }

    .section-title{
      display:flex;
      align-items:center;
      justify-content:space-between;
      margin: 16px 0 10px;
    }
    .section-title h3{
      margin:0;
      font-size: 12px;
      color: rgba(234,242,255,.70);
      text-transform: uppercase;
      letter-spacing: 1.2px;
    }

    .grid{
      display:grid;
      grid-template-columns: repeat(1, minmax(0, 1fr));
      gap: 14px;
    }
    @media (min-width: 760px){
      .grid{ grid-template-columns: repeat(2, minmax(0,1fr)); gap: 16px; }
    }
    @media (min-width: 1200px){
      .grid{ grid-template-columns: repeat(3, minmax(0,1fr)); gap: 18px; }
    }

    .card{
      border-radius: var(--r);
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.06);
      box-shadow: 0 1px 0 rgba(255,255,255,.02);
      padding: 16px;
      min-height: 190px;
      display:flex;
      flex-direction:column;
      overflow:hidden;
      position:relative;
      transition: transform .14s ease, box-shadow .14s ease, border-color .14s ease, background .14s ease;
    }
    .card::after{
      content:"";
      position:absolute;
      width: 240px; height: 240px;
      border-radius: 999px;
      top:-130px; right:-130px;
      background: radial-gradient(circle, rgba(56,189,248,.16), rgba(56,189,248,0) 65%);
      pointer-events:none;
    }
    .card:hover{
      transform: translateY(-2px);
      box-shadow: var(--shadow);
      border-color: rgba(56,189,248,.40);
      background: rgba(255,255,255,.09);
    }

    .card-head{
      display:flex; justify-content:space-between; align-items:flex-start; gap: 10px;
      margin-bottom: 10px;
    }
    .card-title{
      display:flex; gap: 10px; align-items:center;
    }
    .icon{
      width: 44px; height: 44px; border-radius: 16px;
      display:flex; align-items:center; justify-content:center;
      color: white;
      font-weight: 950;
      box-shadow: 0 14px 30px rgba(0,0,0,.35);
      user-select:none;
      border: 1px solid rgba(255,255,255,.14);
    }
    .i-live{ background: linear-gradient(135deg, rgba(34,211,238,.95), rgba(37,99,235,.95)); }
    .i-early{ background: linear-gradient(135deg, rgba(56,189,248,.92), rgba(34,211,238,.92)); }
    .i-report{ background: linear-gradient(135deg, rgba(37,99,235,.90), rgba(34,211,238,.80)); }
    .i-bim{ background: linear-gradient(135deg, rgba(29,78,216,.92), rgba(37,99,235,.92)); }
    .i-ber{ background: linear-gradient(135deg, rgba(34,211,238,.86), rgba(56,189,248,.92)); }
    .i-products{ background: linear-gradient(135deg, rgba(56,189,248,.92), rgba(34,211,238,.86)); }

    .card h4{ margin:0; font-size: 16px; letter-spacing: .1px; }
    .card p{ margin: 6px 0 0; color: rgba(234,242,255,.76); font-size: 13px; line-height:1.5; }

    .cta{
      margin-top:auto;
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap: 10px;
      padding-top: 12px;
    }

    .view{ display:none; }
    .view.active{ display:block; }

    .chat-shell{
      border-radius: var(--r);
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.06);
      box-shadow: var(--shadow2);
      overflow:hidden;
    }
    .chat-top{
      display:flex; align-items:center; justify-content:space-between;
      padding: 14px 14px;
      border-bottom: 1px solid rgba(255,255,255,.10);
      background: rgba(6,12,26,.45);
      backdrop-filter: blur(10px);
    }
    .chat-top strong{ font-size: 14px; }
    .chat-top span{ font-size: 12px; color: rgba(234,242,255,.70); }

    .chat-help{
      padding: 14px;
      border-bottom: 1px solid rgba(255,255,255,.08);
      display:flex;
      gap: 10px;
      flex-wrap: wrap;
    }
    .chip{
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.06);
      color: var(--text);
      padding: 9px 10px;
      border-radius: 999px;
      font-size: 12px;
      font-weight: 950;
      cursor:pointer;
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
    }
    .chip:hover{ transform: translateY(-1px); background: rgba(255,255,255,.10); border-color: rgba(56,189,248,.22); }

    .chat-log{
      height: 60vh;
      overflow-y:auto;
      padding: 14px;
      background:
        radial-gradient(900px 480px at 20% 0%, rgba(37,99,235,.14), rgba(37,99,235,0) 60%),
        radial-gradient(900px 480px at 90% 10%, rgba(56,189,248,.10), rgba(56,189,248,0) 55%),
        rgba(0,0,0,.10);
    }
    .msg{ display:flex; margin-bottom: 12px; }
    .msg.user{ justify-content:flex-end; }

    .bubble{
      max-width: min(780px, 92%);
      padding: 10px 12px;
      border-radius: 16px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.06);
      box-shadow: 0 1px 0 rgba(255,255,255,.03);
      font-size: 13px;
      line-height: 1.55;
      white-space: pre-wrap;
    }
    .msg.user .bubble{
      background: linear-gradient(135deg, rgba(34,211,238,.92), rgba(37,99,235,.92));
      border-color: rgba(56,189,248,.28);
    }

    .meta{
      font-size: 11px;
      color: rgba(234,242,255,.55);
      margin-top: 6px;
    }
    .msg.user .meta{ text-align:right; }

    .typing{
      display:inline-flex;
      align-items:center;
      gap: 6px;
      color: rgba(234,242,255,.70);
    }
    .dots{
      display:inline-flex;
      gap: 4px;
      transform: translateY(1px);
    }
    .dots span{
      width: 6px; height: 6px;
      border-radius: 99px;
      background: rgba(234,242,255,.42);
      animation: dot 1.2s infinite ease-in-out;
    }
    .dots span:nth-child(2){ animation-delay: .15s; }
    .dots span:nth-child(3){ animation-delay: .30s; }
    @keyframes dot{
      0%,100%{ opacity:.35; transform: translateY(0); }
      50%{ opacity:1; transform: translateY(-2px); }
    }

    .chat-input{
      display:flex;
      gap: 10px;
      align-items:flex-end;
      padding: 12px;
      border-top: 1px solid rgba(255,255,255,.10);
      background: rgba(6,12,26,.55);
      backdrop-filter: blur(10px);
      position: sticky;
      bottom: 0;
    }
    textarea{
      width:100%;
      min-height: 46px;
      max-height: 160px;
      resize:none;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(3,7,16,.86);
      color: var(--text);
      font-family: var(--font);
      font-size: 13px;
      padding: 10px 12px;
      line-height: 1.35;
    }
    textarea::placeholder{ color: rgba(234,242,255,.55); }
    textarea:focus{ outline: 3px solid rgba(56,189,248,.22); outline-offset: 2px; }

    .footer{
      margin-top: 16px;
      padding: 14px 4px 0;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 12px;
      color: rgba(234,242,255,.62);
      font-size: 12px;
      flex-wrap: wrap;
    }
    .footer-left{
      display:flex;
      align-items:center;
      gap: 10px;
      flex-wrap: wrap;
    }
    .sep{
      width: 6px; height: 6px;
      border-radius: 99px;
      background: rgba(56,189,248,.35);
      box-shadow: 0 0 0 4px rgba(56,189,248,.10);
    }
  </style>
</head>

<body>
  <div class="app">
    <aside class="sidebar">
      <div class="brand">
        <div class="logo" aria-label="Raheem AI logo">
          <svg viewBox="0 0 48 48" fill="none" aria-hidden="true" xmlns="http://www.w3.org/2000/svg">
            <rect x="7" y="7" width="34" height="34" rx="7" stroke="rgba(255,255,255,.92)" stroke-width="2"/>
            <path d="M15 16H30V30H22.5C18.9 30 16 27.1 16 23.5V16Z" stroke="rgba(255,255,255,.88)" stroke-width="2"/>
            <path d="M22.5 30V35" stroke="rgba(255,255,255,.88)" stroke-width="2" stroke-linecap="round"/>
            <path d="M13 24H20" stroke="rgba(255,255,255,.40)" stroke-width="1.6" stroke-linecap="round"/>
            <path d="M13 20H20" stroke="rgba(255,255,255,.40)" stroke-width="1.6" stroke-linecap="round"/>
            <path d="M13 28H20" stroke="rgba(255,255,255,.40)" stroke-width="1.6" stroke-linecap="round"/>
            <path d="M30.5 19.5L34 23" stroke="rgba(255,255,255,.96)" stroke-width="2.6" stroke-linecap="round"/>
            <path d="M34 23L40 17" stroke="rgba(255,255,255,.96)" stroke-width="2.6" stroke-linecap="round"/>
          </svg>
        </div>
        <div>
          <h1>Raheem AI</h1>
          <p>Construction Compliance Intelligence</p>
          <div class="tagline">Ask naturally. Raheem AI chooses the right guidance and finds the answer.</div>
        </div>
      </div>

      <div class="doc-panel">
        <div class="doc-head">
          <div>
            <div class="doc-title">Document Mode</div>
            <div class="doc-sub">Auto mode is recommended. Choose a document only if you want to force it.</div>
          </div>
          <span class="pill brand" id="pdfCount">Documents: 0</span>
        </div>

        <div class="field">
          <label class="label" for="pdfSearch">
            Search documents
            <span class="pill" id="lastSync">Updated just now</span>
          </label>
          <input id="pdfSearch" class="input" type="text" placeholder="Type to filter..." />
        </div>

        <div class="field">
          <label class="label" for="pdfSelect">Force a document (optional)</label>
          <select id="pdfSelect">
            <option value="">Auto (Raheem AI chooses)</option>
          </select>
        </div>

        <div class="doc-badge-row">
          <span class="mini warn" id="serviceStatus"><span class="dot"></span>Connecting</span>
          <span class="mini" id="activeDocPill"><span class="dot"></span>Auto mode</span>
        </div>
      </div>

      <div class="nav">
        <button id="navDashboard" type="button">
          Dashboard
          <span class="pill live">Live</span>
        </button>

        <button id="navChat" type="button">
          Compliance Guidance
          <span class="pill live">Live</span>
        </button>

        <button id="navFuture" type="button">
          Future Features
          <span class="pill brand">Roadmap</span>
        </button>
      </div>

      <div class="history-panel" id="historyPanel">
        <div class="history-head">
          <h3 class="history-title">Previous Chats</h3>
          <div class="history-actions">
            <button class="btn-mini" type="button" id="btnNewChat">New</button>
            <button class="btn-mini" type="button" id="btnClearChats">Clear</button>
          </div>
        </div>
        <div class="history-list" id="historyList"></div>
      </div>
    </aside>

    <main class="content">
      <section id="view-dashboard" class="view active">
        <div class="topbar">
          <div class="hero">
            <h2>Raheem AI <span class="pill brand">2026</span></h2>
            <p>
              Raheem AI helps professionals navigate Irish building regulation guidance more efficiently.
              Ask a question in plain language. Raheem AI identifies the relevant guidance, searches it, and answers with supporting references.
            </p>
            <div class="quote">Good compliance starts early, when design decisions are still easy to change.</div>
          </div>

          <div class="auth-top">
            <div class="auth-title">
              <span>Sign in</span>
              <span class="pill brand">Coming</span>
            </div>
            <button class="btn small" type="button">
              Continue with Google
            </button>
            <div class="auth-hint">
              Sign in will enable saved projects, access control, and shared chat history.
            </div>
          </div>
        </div>

        <div class="section-title"><h3>Live</h3></div>

        <div class="grid">
          <article class="card" id="cardCompliance" role="button" tabindex="0">
            <div class="card-head">
              <div class="card-title">
                <div class="icon i-live">CG</div>
                <div>
                  <h4>Compliance Guidance</h4>
                  <p>Ask anything. Raheem AI chooses the most relevant TGD and finds the answer logically.</p>
                </div>
              </div>
              <span class="pill live">Live</span>
            </div>
            <div class="cta">
              <span class="pill brand" id="chipDoc">Auto mode</span>
              <button class="btn primary" id="btnOpenChat" type="button">Start</button>
            </div>
          </article>

          <article class="card" id="cardRoadmap" role="button" tabindex="0">
            <div class="card-head">
              <div class="card-title">
                <div class="icon i-early">FF</div>
                <div>
                  <h4>Future Features</h4>
                  <p>Explore planned capabilities including Early Design, DAC, certificates, model review, and energy compliance.</p>
                </div>
              </div>
              <span class="pill brand">Roadmap</span>
            </div>
            <div class="cta">
              <span class="pill brand">Future Features</span>
              <button class="btn" id="btnOpenFuture" type="button">View</button>
            </div>
          </article>
        </div>

        <div class="footer">
          <div class="footer-left">
            <span class="pill brand">Raheem AI</span>
            <span class="sep" aria-hidden="true"></span>
            <span>Built 2026</span>
            <span class="sep" aria-hidden="true"></span>
            <span>Abdulraheem Hayder Ahmed · C22310933 · TU Dublin · Architectural Technology</span>
          </div>
        </div>
      </section>

      <section id="view-future" class="view">
        <div class="hero" style="margin-bottom:14px;">
          <h2>Future Features <span class="pill brand">Roadmap</span></h2>
          <p>
            These capabilities expand Raheem AI from guidance into a complete compliance and certification platform,
            designed for professional workflows and clear outputs that support verification.
          </p>
          <div class="quote">Move faster by knowing earlier. Reduce rework by catching risks before they become drawings.</div>
        </div>

        <div class="grid">
          <article class="card">
            <div class="card-head">
              <div class="card-title">
                <div class="icon i-early">ED</div>
                <div>
                  <h4>Early Design</h4>
                  <p>Enter your area and requirements. Raheem AI generates multiple basic layout options and you choose what works best.</p>
                </div>
              </div>
              <span class="pill brand">Roadmap</span>
            </div>
            <div class="cta">
              <span class="pill brand">Example: 30m2, 2 bed, kitchen</span>
              <button class="btn" type="button">Preview</button>
            </div>
          </article>

          <article class="card">
            <div class="card-head">
              <div class="card-title">
                <div class="icon i-report">DAC</div>
                <div>
                  <h4>DAC Report Generator</h4>
                  <p>Draft structured DAC reports with key checks aligned to access guidance and project inputs.</p>
                </div>
              </div>
              <span class="pill brand">Roadmap</span>
            </div>
            <div class="cta">
              <span class="pill brand">Access and use</span>
              <button class="btn" type="button">Preview</button>
            </div>
          </article>
        </div>

        <div class="footer">
          <div class="footer-left">
            <span class="pill brand">Raheem AI</span>
            <span class="sep" aria-hidden="true"></span>
            <span>Built 2026</span>
            <span class="sep" aria-hidden="true"></span>
            <span>Abdulraheem Hayder Ahmed · C22310933 · TU Dublin · Architectural Technology</span>
          </div>
        </div>
      </section>

      <section id="view-chat" class="view">
        <div class="chat-shell">
          <div class="chat-top">
            <div>
              <strong>Compliance Guidance</strong><br>
              <span id="chatSub">Auto mode: Raheem AI chooses the right guidance</span>
            </div>
            <button class="btn" id="btnBack" type="button">Back</button>
          </div>

          <div class="chat-help">
            <button class="chip" type="button" data-prompt="What are the typical travel distance limits for an office?">Travel distance</button>
            <button class="chip" type="button" data-prompt="What are the key requirements for an accessible WC?">Accessible WC</button>
            <button class="chip" type="button" data-prompt="What are the main requirements for stair widths?">Stairs</button>
            <button class="chip" type="button" data-prompt="What is the difference between compartments and sub-compartments?">Compartmentation</button>
          </div>

          <div class="chat-log" id="chatLog"></div>

          <div class="chat-input">
            <textarea id="chatInput" placeholder="Ask a compliance question... (Enter to send, Shift+Enter for a new line)"></textarea>
            <button class="btn primary" id="btnSend" type="button">Send</button>
          </div>
        </div>
      </section>
    </main>
  </div>

  <script>
    const API_BASE = "https://complyr.onrender.com";

    const viewDashboard = document.getElementById("view-dashboard");
    const viewFuture = document.getElementById("view-future");
    const viewChat = document.getElementById("view-chat");

    const navDashboard = document.getElementById("navDashboard");
    const navChat = document.getElementById("navChat");
    const navFuture = document.getElementById("navFuture");

    function setNavActive(which){
      navDashboard.classList.toggle("active", which === "dashboard");
      navChat.classList.toggle("active", which === "chat");
      navFuture.classList.toggle("active", which === "future");
    }

    function showView(name){
      viewDashboard.classList.toggle("active", name === "dashboard");
      viewChat.classList.toggle("active", name === "chat");
      viewFuture.classList.toggle("active", name === "future");
      setNavActive(name);
      if(name === "chat"){
        setTimeout(() => document.getElementById("chatInput").focus(), 40);
      }
    }

    function goDash(){ location.hash = "#/"; }
    function openChat(){ location.hash = "#/chat"; }
    function openFuture(){ location.hash = "#/future"; }

    function handleRoute(){
      const h = location.hash || "#/";
      if(h === "#/chat") showView("chat");
      else if(h === "#/future") showView("future");
      else showView("dashboard");
    }
    window.addEventListener("hashchange", handleRoute);
    handleRoute();

    navDashboard.addEventListener("click", goDash);
    navChat.addEventListener("click", openChat);
    navFuture.addEventListener("click", openFuture);

    document.getElementById("btnOpenChat").addEventListener("click", openChat);
    document.getElementById("cardCompliance").addEventListener("click", openChat);
    document.getElementById("cardCompliance").addEventListener("keydown", (e)=>{
      if(e.key === "Enter" || e.key === " ") openChat();
    });

    document.getElementById("btnOpenFuture").addEventListener("click", openFuture);
    document.getElementById("cardRoadmap").addEventListener("click", openFuture);
    document.getElementById("cardRoadmap").addEventListener("keydown", (e)=>{
      if(e.key === "Enter" || e.key === " ") openFuture();
    });

    const pdfCount = document.getElementById("pdfCount");
    const pdfSelect = document.getElementById("pdfSelect");
    const pdfSearch = document.getElementById("pdfSearch");
    const chatSub = document.getElementById("chatSub");
    const activeDocPill = document.getElementById("activeDocPill");
    const chipDoc = document.getElementById("chipDoc");
    const serviceStatus = document.getElementById("serviceStatus");
    const lastSync = document.getElementById("lastSync");

    let allDocs = [];
    let activePdf = ""; // empty means Auto mode

    function setActivePdf(name){
      activePdf = name || "";
      if(!activePdf){
        chatSub.textContent = "Auto mode: Raheem AI chooses the right guidance";
        activeDocPill.innerHTML = '<span class="dot"></span>Auto mode';
        chipDoc.textContent = "Auto mode";
      } else {
        chatSub.textContent = "Forced document: " + activePdf;
        activeDocPill.innerHTML = '<span class="dot"></span>' + activePdf;
        chipDoc.textContent = "Forced document";
      }
      persistActiveChat();
      renderHistory();
    }

    function setSyncLabel(){
      const d = new Date();
      const t = d.toLocaleTimeString([], {hour:"2-digit", minute:"2-digit"});
      lastSync.textContent = "Updated " + t;
    }

    function fillSelect(list){
      const current = activePdf;
      pdfSelect.innerHTML = "";
      const autoOpt = document.createElement("option");
      autoOpt.value = "";
      autoOpt.textContent = "Auto (Raheem AI chooses)";
      pdfSelect.appendChild(autoOpt);

      const sorted = list.slice().sort((a,b)=>a.localeCompare(b, undefined, {sensitivity:"base"}));
      for(const name of sorted){
        const opt = document.createElement("option");
        opt.value = name;
        opt.textContent = name;
        pdfSelect.appendChild(opt);
      }
      pdfSelect.value = current; // stays Auto by default
    }

    async function refreshDocs(){
      try{
        const r = await fetch(API_BASE + "/pdfs", { cache: "no-store" });
        if(!r.ok) throw new Error("bad");
        const data = await r.json();
        allDocs = Array.isArray(data.pdfs) ? data.pdfs : [];
        pdfCount.textContent = "Documents: " + (typeof data.count === "number" ? data.count : allDocs.length);

        serviceStatus.classList.add("ok");
        serviceStatus.classList.remove("warn");
        serviceStatus.innerHTML = '<span class="dot"></span>Service ready';

        setSyncLabel();
        fillSelect(allDocs);

        // If user previously forced a doc that no longer exists, reset to Auto
        if(activePdf && !allDocs.includes(activePdf)){
          setActivePdf("");
          pdfSelect.value = "";
        }

      } catch(e){
        pdfCount.textContent = "Documents: 0";
        serviceStatus.classList.remove("ok");
        serviceStatus.classList.add("warn");
        serviceStatus.innerHTML = '<span class="dot"></span>Service unavailable';
        pdfSelect.innerHTML = '<option value="">Auto (Raheem AI chooses)</option>';
        setSyncLabel();
      }
    }

    pdfSelect.addEventListener("change", ()=> setActivePdf(pdfSelect.value));
    pdfSearch.addEventListener("input", ()=>{
      const q = pdfSearch.value.trim().toLowerCase();
      const filtered = !q ? allDocs : allDocs.filter(n => n.toLowerCase().includes(q));
      fillSelect(filtered);
      pdfSelect.value = activePdf;
    });

    refreshDocs();
    setInterval(refreshDocs, 8000);

    const chatLog = document.getElementById("chatLog");
    const chatInput = document.getElementById("chatInput");
    const btnSend = document.getElementById("btnSend");
    document.getElementById("btnBack").addEventListener("click", goDash);

    document.querySelectorAll("[data-prompt]").forEach(btn=>{
      btn.addEventListener("click", ()=>{
        chatInput.value = btn.getAttribute("data-prompt");
        chatInput.focus();
      });
    });

    let activeStream = null;

    function stamp(){
      const d = new Date();
      return d.toLocaleTimeString([], {hour:"2-digit", minute:"2-digit"});
    }

    function stopActiveStream(){
      try{ if(activeStream){ activeStream.close(); activeStream = null; } }catch(e){}
    }

    function addMessageDom(role, text, time){
      const wrap = document.createElement("div");
      wrap.className = "msg " + (role === "user" ? "user" : "assistant");

      const bubble = document.createElement("div");
      bubble.className = "bubble";
      bubble.textContent = text || "";

      const meta = document.createElement("div");
      meta.className = "meta";
      meta.textContent = time || stamp();

      const container = document.createElement("div");
      container.appendChild(bubble);
      container.appendChild(meta);

      wrap.appendChild(container);
      chatLog.appendChild(wrap);
      chatLog.scrollTop = chatLog.scrollHeight;

      return {wrap, bubble, meta};
    }

    function setTyping(bubbleEl, on){
      if(!bubbleEl) return;
      if(on){
        bubbleEl.innerHTML = '';
        const span = document.createElement("span");
        span.className = "typing";
        span.textContent = "Raheem AI is typing";
        const dots = document.createElement("span");
        dots.className = "dots";
        dots.innerHTML = "<span></span><span></span><span></span>";
        span.appendChild(dots);
        bubbleEl.appendChild(span);
      } else {
        bubbleEl.textContent = "";
      }
      chatLog.scrollTop = chatLog.scrollHeight;
    }

    function buildStreamUrl(question){
      const params = new URLSearchParams();
      params.set("q", question);
      if(activePdf){
        params.set("pdf", activePdf);
      }
      return API_BASE + "/ask_stream?" + params.toString();
    }

    // Local chat history
    const STORAGE_KEY = "raheem_ai_chats_v2";
    let chats = [];
    let activeChatId = null;

    function loadChats(){
      try{
        const raw = localStorage.getItem(STORAGE_KEY);
        chats = raw ? JSON.parse(raw) : [];
        if(!Array.isArray(chats)) chats = [];
      } catch(e){ chats = []; }
    }
    function saveChats(){
      try{ localStorage.setItem(STORAGE_KEY, JSON.stringify(chats)); } catch(e){}
    }
    function newChatTitle(){
      const d = new Date();
      const date = d.toLocaleDateString([], {year:"numeric", month:"short", day:"2-digit"});
      const time = d.toLocaleTimeString([], {hour:"2-digit", minute:"2-digit"});
      return "Chat " + date + " " + time;
    }
    function createChat(){
      const id = "c_" + Math.random().toString(16).slice(2) + Date.now().toString(16);
      const chat = { id, title: newChatTitle(), createdAt: Date.now(), updatedAt: Date.now(), forcedPdf: activePdf || "", messages: [] };
      chats.unshift(chat);
      activeChatId = id;
      saveChats();
      renderHistory();
      renderActiveChat();
      return chat;
    }
    function getActiveChat(){ return chats.find(c => c.id === activeChatId) || null; }
    function setActiveChat(id){
      const c = chats.find(x => x.id === id);
      if(!c) return;
      activeChatId = id;
      // restore forced doc only if it exists; otherwise auto
      if(c.forcedPdf && allDocs.includes(c.forcedPdf)){
        setActivePdf(c.forcedPdf);
        pdfSelect.value = c.forcedPdf;
      } else {
        setActivePdf("");
        pdfSelect.value = "";
      }
      renderHistory();
      renderActiveChat();
    }
    function persistActiveChat(){
      const c = getActiveChat();
      if(!c) return;
      c.updatedAt = Date.now();
      c.forcedPdf = activePdf || "";
      saveChats();
    }
    function addMsgToChat(role, text){
      const c = getActiveChat();
      if(!c) return;
      c.messages.push({ role, text: text || "", time: stamp() });
      c.updatedAt = Date.now();
      c.forcedPdf = activePdf || "";
      saveChats();
      renderHistory();
    }
    function lastMeaningfulPreview(chat){
      const arr = chat.messages || [];
      for(let i = arr.length - 1; i >= 0; i--){
        const t = (arr[i].text || "").trim();
        if(t) return t;
      }
      return "No messages yet.";
    }
    function formatSmallTime(ts){
      const d = new Date(ts);
      return d.toLocaleTimeString([], {hour:"2-digit", minute:"2-digit"});
    }
    function escapeHtml(s){
      return String(s).replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#039;");
    }

    const historyList = document.getElementById("historyList");
    const btnNewChat = document.getElementById("btnNewChat");
    const btnClearChats = document.getElementById("btnClearChats");

    function renderHistory(){
      historyList.innerHTML = "";
      if(!chats.length){
        const empty = document.createElement("div");
        empty.className = "history-item";
        empty.style.cursor = "default";
        empty.innerHTML = '<div class="history-name">No saved chats yet</div><div class="history-preview">Start a chat and it will appear here.</div>';
        historyList.appendChild(empty);
        return;
      }
      for(const c of chats){
        const item = document.createElement("div");
        item.className = "history-item" + (c.id === activeChatId ? " active" : "");
        item.tabIndex = 0;

        const preview = lastMeaningfulPreview(c);
        const meta = formatSmallTime(c.updatedAt || c.createdAt);

        item.innerHTML = `
          <div class="history-row">
            <div class="history-name">${escapeHtml(c.title || "Chat")}</div>
            <div class="history-meta">${meta}</div>
          </div>
          <div class="history-preview">${escapeHtml(preview)}</div>
          <div class="history-controls">
            <button class="history-btn" data-act="open" data-id="${c.id}">Open</button>
            <button class="history-btn" data-act="rename" data-id="${c.id}">Rename</button>
            <button class="history-btn" data-act="delete" data-id="${c.id}">Delete</button>
          </div>
        `;

        item.addEventListener("click", (e)=>{
          const btn = e.target.closest("button");
          if(btn){
            const act = btn.getAttribute("data-act");
            const id = btn.getAttribute("data-id");
            if(act === "open") setActiveChat(id);
            if(act === "rename") renameChat(id);
            if(act === "delete") deleteChat(id);
            return;
          }
          setActiveChat(c.id);
        });

        item.addEventListener("keydown", (e)=>{
          if(e.key === "Enter" || e.key === " "){
            e.preventDefault();
            setActiveChat(c.id);
          }
        });

        historyList.appendChild(item);
      }
    }

    function renameChat(id){
      const c = chats.find(x => x.id === id);
      if(!c) return;
      const name = prompt("Rename chat", c.title || "Chat");
      if(name === null) return;
      const cleaned = (name || "").trim();
      if(!cleaned) return;
      c.title = cleaned;
      c.updatedAt = Date.now();
      saveChats();
      renderHistory();
    }

    function deleteChat(id){
      const c = chats.find(x => x.id === id);
      if(!c) return;
      if(!confirm("Delete this chat?")) return;
      chats = chats.filter(x => x.id !== id);
      if(activeChatId === id){
        activeChatId = chats.length ? chats[0].id : null;
      }
      saveChats();
      renderHistory();
      renderActiveChat();
    }

    function clearAllChats(){
      if(!confirm("Clear all saved chats? This cannot be undone.")) return;
      chats = [];
      activeChatId = null;
      saveChats();
      renderHistory();
      renderActiveChat();
    }

    btnNewChat.addEventListener("click", ()=>{ createChat(); openChat(); });
    btnClearChats.addEventListener("click", clearAllChats);

    function renderActiveChat(){
      chatLog.innerHTML = "";
      const c = getActiveChat();
      if(!c){
        const created = createChat();
        created.messages.push({
          role: "assistant",
          text: "Hi. Ask your question normally and I will work out which guidance applies, then find the answer. If you want to force a document you can choose one on the left, but Auto mode is recommended.",
          time: stamp()
        });
        saveChats();
        renderHistory();
        renderActiveChat();
        return;
      }
      for(const m of (c.messages || [])){
        addMessageDom(m.role, m.text, m.time);
      }
      chatLog.scrollTop = chatLog.scrollHeight;
    }

    loadChats();
    if(chats.length) activeChatId = chats[0].id;
    renderHistory();
    renderActiveChat();

    async function send(){
      const raw = chatInput.value.trim();
      if(!raw) return;

      stopActiveStream();
      addMsgToChat("user", raw);
      renderActiveChat();
      chatInput.value = "";

      const timeNow = stamp();
      const assistantDom = addMessageDom("assistant", "", timeNow);
      setTyping(assistantDom.bubble, true);

      const url = buildStreamUrl(raw);
      let buffer = "";

      try{
        activeStream = new EventSource(url);

        activeStream.addEventListener("error", () => {
          stopActiveStream();
          setTyping(assistantDom.bubble, false);
          const msg = "The service is currently unavailable. Please try again in a moment.";
          assistantDom.bubble.textContent = msg;
          addMsgToChat("assistant", msg);
        });

        activeStream.addEventListener("done", () => {
          stopActiveStream();
          const finalText = (buffer || "").trim() || "No response available.";
          assistantDom.bubble.textContent = finalText;
          addMsgToChat("assistant", finalText);
          persistActiveChat();
          renderHistory();
        });

        activeStream.onmessage = (e) => {
          const chunk = (e.data || "").replaceAll("\\n", "\n");
          if(!buffer){
            setTyping(assistantDom.bubble, false);
          }
          buffer += chunk;
          assistantDom.bubble.textContent = buffer;
          chatLog.scrollTop = chatLog.scrollHeight;
        };

      } catch(err){
        stopActiveStream();
        setTyping(assistantDom.bubble, false);
        const msg = "The service is currently unavailable. Please try again in a moment.";
        assistantDom.bubble.textContent = msg;
        addMsgToChat("assistant", msg);
      }
    }

    btnSend.addEventListener("click", send);
    chatInput.addEventListener("keydown", (e)=>{
      if(e.key === "Enter" && !e.shiftKey){
        e.preventDefault();
        send();
      }
    });

    document.querySelectorAll("[data-prompt]").forEach(btn=>{
      btn.addEventListener("click", ()=>{
        chatInput.value = btn.getAttribute("data-prompt");
        chatInput.focus();
      });
    });
  </script>
</body>
</html>
