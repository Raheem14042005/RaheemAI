<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Raheem AI ‚Äî Maintenance</title>
  <style>
    :root{
      --bg:#0b0f17;
      --card:rgba(255,255,255,.07);
      --card2:rgba(255,255,255,.05);
      --text:rgba(255,255,255,.92);
      --muted:rgba(255,255,255,.68);
      --accent:#7c3aed;
      --accent2:#22c55e;
      --warn:#fde68a;
      --bad:#fca5a5;
      --shadow: 0 20px 60px rgba(0,0,0,.35);
      --radius: 18px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      min-height:100vh;
      display:grid;
      place-items:center;
      background:
        radial-gradient(1200px 600px at 70% 20%, rgba(124,58,237,.18), transparent 60%),
        radial-gradient(900px 500px at 20% 80%, rgba(34,197,94,.12), transparent 60%),
        var(--bg);
      color:var(--text);
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Apple Color Emoji","Segoe UI Emoji";
      padding:24px;
    }

    .wrap{
      width:min(1100px, 100%);
      display:grid;
      gap:18px;
      grid-template-columns: 1.25fr .75fr;
    }
    @media (max-width: 980px){ .wrap{grid-template-columns:1fr} }

    .card{
      background:linear-gradient(180deg, var(--card), var(--card2));
      border:1px solid rgba(255,255,255,.10);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      overflow:hidden;
    }
    .pad{padding:18px 18px 14px}

    .top{
      display:flex;
      gap:12px;
      align-items:flex-start;
      justify-content:space-between;
      flex-wrap:wrap;
    }
    .title{
      font-size:clamp(22px, 3vw, 34px);
      line-height:1.1;
      margin:0;
      letter-spacing:-0.02em;
    }
    .subtitle{
      margin:8px 0 0;
      color:var(--muted);
      font-size:14px;
      line-height:1.5;
      max-width:76ch;
    }

    .pillrow{display:flex; gap:8px; flex-wrap:wrap; margin-top:12px}
    .pill{
      font-size:12px;
      color:rgba(255,255,255,.86);
      border:1px solid rgba(255,255,255,.12);
      background:rgba(255,255,255,.06);
      padding:7px 10px;
      border-radius:999px;
      user-select:none;
      white-space:nowrap;
    }
    .pill b{color:white}

    .progress{
      margin-top:14px;
      height:10px;
      border-radius:999px;
      background:rgba(255,255,255,.08);
      overflow:hidden;
      border:1px solid rgba(255,255,255,.10);
    }
    .bar{
      height:100%;
      width:0%;
      border-radius:999px;
      background:linear-gradient(90deg, var(--accent), #3b82f6);
      transition:width .6s ease;
    }
    .small{
      margin:10px 0 0;
      color:var(--muted);
      font-size:12px;
      display:flex;
      justify-content:space-between;
      gap:10px;
      flex-wrap:wrap;
    }
    .small code{
      background:rgba(0,0,0,.25);
      padding:2px 6px;
      border-radius:8px;
      border:1px solid rgba(255,255,255,.10);
      color:rgba(255,255,255,.85);
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
    }

    /* Buttons */
    .btns{display:flex; gap:8px; flex-wrap:wrap; align-items:center}
    button{
      border:1px solid rgba(255,255,255,.14);
      background:rgba(255,255,255,.06);
      color:rgba(255,255,255,.92);
      padding:9px 12px;
      border-radius:12px;
      cursor:pointer;
      font-weight:800;
      font-size:13px;
    }
    button:hover{background:rgba(255,255,255,.10)}
    button:active{transform:translateY(1px)}
    .primary{
      background:rgba(124,58,237,.22);
      border-color:rgba(124,58,237,.45);
    }
    .danger{
      background:rgba(239,68,68,.18);
      border-color:rgba(239,68,68,.35);
    }

    /* Snake */
    canvas{
      width:100%;
      height:auto;
      display:block;
      /* not black anymore */
      background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(0,0,0,.05));
    }
    .gameHeader{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
      padding:14px 18px;
      border-top:1px solid rgba(255,255,255,.10);
      background:rgba(0,0,0,.18);
      flex-wrap:wrap;
    }
    .stats{display:flex; gap:12px; flex-wrap:wrap; font-size:12px; color:var(--muted)}
    .stats span{color:rgba(255,255,255,.88)}
    .kbd{
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
      font-size: 12px;
      border:1px solid rgba(255,255,255,.18);
      background:rgba(255,255,255,.06);
      padding:2px 6px;
      border-radius:8px;
      color:rgba(255,255,255,.88);
    }

    /* Right column */
    .h2{margin:0 0 10px; font-size:16px; letter-spacing:-0.01em;}
    .log{
      border:1px dashed rgba(255,255,255,.16);
      border-radius:14px;
      padding:12px;
      background:rgba(0,0,0,.18);
      min-height:170px;
      font-size:13px;
      color:rgba(255,255,255,.86);
      line-height:1.5;
    }
    .log .muted{color:var(--muted)}
    .log .ok{color: #86efac}
    .log .warn{color: #fde68a}
    .log .nope{color: #fca5a5}

    .panel{
      margin-top:12px;
      padding:12px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.10);
      background:rgba(0,0,0,.12);
    }

    .meter{
      height:10px;
      border-radius:999px;
      background:rgba(255,255,255,.08);
      border:1px solid rgba(255,255,255,.10);
      overflow:hidden;
      margin-top:8px;
    }
    .meter > div{
      height:100%;
      width:0%;
      background:linear-gradient(90deg, #22c55e, #fde68a, #ef4444);
      transition:width .4s ease;
    }

    .bingo{
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap:8px;
      margin-top:10px;
    }
    .tile{
      padding:10px 10px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.12);
      background:rgba(255,255,255,.06);
      font-size:12px;
      cursor:pointer;
      user-select:none;
      line-height:1.2;
    }
    .tile.on{
      background:rgba(34,197,94,.18);
      border-color:rgba(34,197,94,.35);
    }

    .footer{
      margin-top:12px;
      font-size:12px;
      color:var(--muted);
    }

    /* Modal (real popup) */
    .modalOverlay{
      position:fixed;
      inset:0;
      background:rgba(0,0,0,.60);
      display:none;
      align-items:center;
      justify-content:center;
      padding:18px;
      z-index:9999;
    }
    .modalOverlay.show{display:flex;}
    .modal{
      width:min(560px, 100%);
      border-radius:18px;
      border:1px solid rgba(255,255,255,.14);
      background:linear-gradient(180deg, rgba(255,255,255,.10), rgba(0,0,0,.28));
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .modalTop{
      padding:14px 16px;
      display:flex;
      justify-content:space-between;
      gap:12px;
      align-items:center;
      border-bottom:1px solid rgba(255,255,255,.10);
      background:rgba(0,0,0,.18);
    }
    .modalTop b{letter-spacing:-0.01em}
    .modalBody{
      padding:16px;
      color:rgba(255,255,255,.92);
      line-height:1.45;
      font-size:14px;
    }
    .modalBody .tiny{
      margin-top:10px;
      color:var(--muted);
      font-size:12px;
    }
    .modalActions{
      padding:14px 16px;
      border-top:1px solid rgba(255,255,255,.10);
      display:flex;
      gap:10px;
      justify-content:flex-end;
      flex-wrap:wrap;
      background:rgba(0,0,0,.12);
    }
  </style>
</head>
<body>

  <!-- Panic Modal -->
  <div class="modalOverlay" id="panicOverlay" role="dialog" aria-modal="true" aria-labelledby="panicTitle">
    <div class="modal">
      <div class="modalTop">
        <b id="panicTitle">üö® PANIC REPORT</b>
        <button id="panicCloseTop" title="Close">‚úñ</button>
      </div>
      <div class="modalBody">
        <div id="panicMsg" style="font-weight:800; font-size:15px"></div>
        <div id="panicSub" style="margin-top:10px"></div>
        <div class="tiny">
          Note: Raheem AI knows TGDs & planning regs by heart‚Ä¶ but even Raheem can‚Äôt fight a rogue semicolon at 3am.
        </div>
      </div>
      <div class="modalActions">
        <button id="panicCopy">Copy official excuse</button>
        <button class="primary" id="panicClose">Close (I‚Äôm calm now)</button>
      </div>
    </div>
  </div>

  <main class="wrap">
    <!-- Left -->
    <section class="card">
      <div class="pad">
        <div class="top">
          <div>
            <h1 class="title">Raheem AI üß†üìò ‚Äî Maintenance Mode</h1>
            <p class="subtitle">
              Raheem AI knows <b>TGDs</b> and <b>planning regs</b> by heart.
              Unfortunately‚Ä¶ the server knows <b>chaos</b> by heart.
              <br><span class="muted">While we fix it, enjoy Snake + maximum nonsense.</span>
            </p>

            <div class="pillrow">
              <div class="pill">Status: <b id="statusText">Negotiating with the database</b></div>
              <div class="pill">Coffee: <b id="coffeeLevel">critical</b></div>
              <div class="pill">Bug count: <b id="bugCount">plotting</b></div>
              <div class="pill">Server mood: <b id="serverMood">moody</b></div>
              <div class="pill">Raheem AI accuracy: <b>99.9%</b> (site uptime: <b>emotionally unavailable</b>)</div>
            </div>

            <div class="progress" aria-label="fake progress bar">
              <div class="bar" id="progressBar"></div>
            </div>
            <div class="small">
              <span>Estimated completion: <code id="eta">soon‚Ñ¢</code></span>
              <span>Actual completion: <code id="truth">ask again later</code></span>
            </div>

            <div class="pillrow" style="margin-top:12px">
              <button class="danger" id="panicBtn">üö® PANIC BUTTON</button>
              <button id="blameBtn">üßæ Generate Blame</button>
              <button class="primary" id="deployBtn">üöÄ Deploy Now</button>
            </div>
          </div>

          <div class="panel" style="min-width:250px; flex:1">
            <div style="font-weight:900; letter-spacing:-0.01em">Rage Meter</div>
            <div class="footer">Increases when you die. Decreases when you stop caring.</div>
            <div class="meter"><div id="rageBar"></div></div>
            <div class="footer"><span id="rageLabel">Calm-ish.</span></div>
          </div>
        </div>
      </div>

      <canvas id="game" width="720" height="480"></canvas>

      <div class="gameHeader">
        <div class="stats">
          <div>Score: <span id="score">0</span></div>
          <div>Best: <span id="best">0</span></div>
          <div>Speed: <span id="speed">1.0x</span></div>
          <div class="muted">
            Controls: <span class="kbd">‚Üë</span><span class="kbd">‚Üì</span><span class="kbd">‚Üê</span><span class="kbd">‚Üí</span> /
            <span class="kbd">WASD</span> ‚Ä¢ Pause <span class="kbd">P</span>
          </div>
        </div>
        <div class="btns">
          <button class="primary" id="startBtn">Start / Restart</button>
          <button id="pauseBtn">Pause</button>
          <button id="hardBtn" title="For the brave (or the bored)">Hard Mode</button>
        </div>
      </div>
    </section>

    <!-- Right -->
    <aside class="card">
      <div class="pad">
        <h2 class="h2">Live Engineering Updates (definitely not copium)</h2>
        <div class="log" id="log"></div>

        <div class="panel">
          <div style="font-weight:900">Developer Excuse Bingo</div>
          <div class="footer">Tap excuses until BINGO. (Still won‚Äôt fix the site, but it‚Äôs character development.)</div>
          <div class="bingo" id="bingo"></div>
          <div class="pillrow" style="margin-top:10px">
            <button id="resetBingo">Reset Bingo</button>
          </div>
        </div>

        <div class="footer">
          If you urgently need Raheem AI, please consult the nearest TGD and whisper ‚Äú<b>Part B</b>‚Äù three times.
        </div>
      </div>
    </aside>
  </main>

  <script>
    // ---------------------------
    // Helpers
    // ---------------------------
    const $ = (id) => document.getElementById(id);
    function randomPick(arr){ return arr[Math.floor(Math.random()*arr.length)]; }

    // ---------------------------
    // Maintenance fluff
    // ---------------------------
    const statusText = $("statusText");
    const coffeeLevel = $("coffeeLevel");
    const bugCount = $("bugCount");
    const serverMood = $("serverMood");
    const progressBar = $("progressBar");
    const eta = $("eta");
    const truth = $("truth");
    const logEl = $("log");

    function addLog(line, cls="muted"){
      const p = document.createElement("div");
      p.innerHTML = `<span class="${cls}">‚Ä¢ ${line}</span>`;
      logEl.prepend(p);
      while(logEl.childNodes.length > 12) logEl.removeChild(logEl.lastChild);
    }

    const statuses = [
      "Negotiating with the database",
      "Turning it off and on again (for spiritual reasons)",
      "Applying duct tape (digital edition)",
      "Reading the error message this time. Maybe.",
      "Updating dependencies (summoning chaos)",
      "Teaching the server empathy",
      "Refactoring (rearranging deck chairs)",
      "Asking the API nicely"
    ];
    const coffees = ["critical", "low", "acceptable", "dangerously optimistic", "espresso-powered"];
    const bugs = ["plotting", "multiplying", "in witness protection", "too confident", "doing parkour"];
    const moods = ["moody", "confused", "surprisingly cooperative", "needs attention", "vibing"];

    let fakeProgress = 0;
    function tickMaintenance(){
      statusText.textContent = randomPick(statuses);
      coffeeLevel.textContent = randomPick(coffees);
      bugCount.textContent = randomPick(bugs);
      serverMood.textContent = randomPick(moods);

      const delta = (Math.random() * 10) - 3; // -3..7
      fakeProgress = Math.max(0, Math.min(97, fakeProgress + delta));
      progressBar.style.width = fakeProgress.toFixed(0) + "%";

      eta.textContent = randomPick(["soon‚Ñ¢", "in a sec", "after one more coffee", "shortly-ish", "after Part L stops judging us"]);
      truth.textContent = randomPick([
        "ask again later",
        "depends on the bug‚Äôs vibe",
        "classified information",
        "when JavaScript feels like it",
        "after we stop touching it"
      ]);

      const logLines = [
        ["Cleared cache. Cache cleared *us* emotionally.", "warn"],
        ["Found a bug. It had a family.", "warn"],
        ["Deployed a fix. Undeployed it for character development.", "nope"],
        ["Server replied: ‚Äòlol‚Äô. Investigating.", "warn"],
        ["Added console.log(). Problem got shy.", "ok"],
        ["Refactored code. Now it‚Äôs ‚Äòart‚Äô.", "ok"],
        ["Database requested boundaries. Respecting that.", "ok"],
        ["Reduced bugs by 0.3%. We take wins.", "muted"],
        ["Raheem AI passed compliance. Server failed vibes.", "warn"],
      ];
      const [line, cls] = randomPick(logLines);
      addLog(line, cls);
    }

    addLog("Raheem AI is warming up‚Ä¶ the server is not.", "ok");
    addLog("Loading TGDs into RAM‚Ä¶ loading patience into humans‚Ä¶ failed.", "warn");
    tickMaintenance();
    setInterval(tickMaintenance, 3200);

    // ---------------------------
    // Panic Modal (real popup)
    // ---------------------------
    const overlay = $("panicOverlay");
    const panicMsg = $("panicMsg");
    const panicSub = $("panicSub");

    const panicLines = [
      {
        title: "CRITICAL ALERT: The server has entered its ‚Äòmain character arc‚Äô.",
        sub: "Recommended action: step away from the keyboard and speak gently to your Wi-Fi router."
      },
      {
        title: "EMERGENCY: A semicolon has escaped containment.",
        sub: "If seen, do not approach. Call Raheem AI or deploy snacks as a distraction."
      },
      {
        title: "WARNING: The database is currently ‚Äòthinking about its life choices‚Äô.",
        sub: "Please allow it space. Emotional growth takes time."
      },
      {
        title: "CODE RED: Someone said ‚Äòquick change‚Äô in production.",
        sub: "This is how legends begin‚Ä¶ and how outages are born."
      },
      {
        title: "ALERT: The site is down, but our confidence is up.",
        sub: "This is not helpful. But it is consistent."
      },
      {
        title: "URGENT: Part B is staring at us.",
        sub: "We are staring back. Nobody is blinking."
      }
    ];

    function openPanic(){
      const m = randomPick(panicLines);
      panicMsg.textContent = m.title;
      panicSub.textContent = m.sub;
      overlay.classList.add("show");
      addLog("PANIC BUTTON pressed. Official meltdown initiated.", "warn");
    }
    function closePanic(){
      overlay.classList.remove("show");
      addLog("Panic resolved. (Not the issue. Just the panic.)", "ok");
    }

    $("panicBtn").addEventListener("click", openPanic);
    $("panicClose").addEventListener("click", closePanic);
    $("panicCloseTop").addEventListener("click", closePanic);
    overlay.addEventListener("click", (e)=>{ if(e.target === overlay) closePanic(); });

    $("panicCopy").addEventListener("click", async ()=>{
      const excuse = "Official excuse: ‚ÄòThe server is currently reviewing TGDs and refusing to comply with vibes.‚Äô";
      try{
        await navigator.clipboard.writeText(excuse);
        addLog("Copied an official excuse to clipboard. Accountability avoided.", "muted");
        alert("Copied!\n\n" + excuse);
      }catch{
        // fallback popup box
        alert("Copy this excuse manually:\n\n" + excuse);
      }
    });

    // ---------------------------
    // Comedy buttons (keep your blame/deploy)
    // ---------------------------
    $("blameBtn").addEventListener("click", ()=>{
      const blame = [
        "Blame assigned to: Wi-Fi spirits.",
        "Blame assigned to: Mercury retrograde.",
        "Blame assigned to: the intern (we don‚Äôt have an intern).",
        "Blame assigned to: a missing semicolon living its best life.",
        "Blame assigned to: ‚Äòthat one plugin‚Äô nobody remembers installing.",
        "Blame assigned to: cosmic rays flipping a bit somewhere (probably).",
        "Blame assigned to: user error (respectfully).",
        "Blame assigned to: Part L judging us again."
      ];
      const msg = randomPick(blame);
      alert(msg); // POPUP BOX (since you like popups üò≠)
      addLog(msg, "warn");
    });

    $("deployBtn").addEventListener("click", ()=>{
      const steps = [
        ["Starting deployment‚Ä¶", "ok"],
        ["Packing pixels into boxes‚Ä¶", "ok"],
        ["Launching rocket üöÄ ‚Ä¶", "ok"],
        ["Rocket has feelings. Comforting rocket‚Ä¶", "warn"],
        ["Deployment complete ‚úÖ", "ok"],
        ["Site status: still maintenance üíÄ", "nope"]
      ];
      let i = 0;
      const t = setInterval(()=>{
        addLog(steps[i][0], steps[i][1]);
        i++;
        if(i >= steps.length){
          clearInterval(t);
          alert("Deployment complete ‚úÖ\n\nResult: still in maintenance üíÄ\n\n(But we looked very busy.)");
        }
      }, 420);
    });

    // ---------------------------
    // Bingo
    // ---------------------------
    const excuses = [
      "It works on my machine",
      "DNS is haunted",
      "Caching issue (trust me)",
      "We‚Äôre ‚Äòoptimizing‚Äô",
      "A ‚Äòquick‚Äô hotfix",
      "Third-party API changed",
      "We‚Äôre ‚Äòmigrating‚Äô stuff",
      "Someone pushed to main",
      "It‚Äôs a feature",
    ];

    const bingoEl = $("bingo");
    function renderBingo(){
      bingoEl.innerHTML = "";
      excuses.forEach((t)=>{
        const d = document.createElement("div");
        d.className = "tile";
        d.textContent = t;
        d.addEventListener("click", ()=>{
          d.classList.toggle("on");
          checkBingo();
        });
        bingoEl.appendChild(d);
      });
    }

    function checkBingo(){
      const tiles = [...bingoEl.querySelectorAll(".tile")];
      const on = tiles.map(t=>t.classList.contains("on"));

      const lines = [
        [0,1,2],[3,4,5],[6,7,8],
        [0,3,6],[1,4,7],[2,5,8],
        [0,4,8],[2,4,6]
      ];
      const bingo = lines.some(line => line.every(i => on[i]));
      if(bingo){
        alert("BINGO! üèÜ\n\nYou have unlocked:\n‚Ä¢ Nothing\n‚Ä¢ More maintenance\n‚Ä¢ Character development");
        addLog("BINGO achieved. Still not fixing the site though.", "ok");
      }
    }

    $("resetBingo").addEventListener("click", ()=>{
      renderBingo();
      addLog("Excuse Bingo reset. Accountability avoided.", "muted");
    });

    renderBingo();

    // ---------------------------
    // Snake Game (with visible colors)
    // ---------------------------
    const canvas = $("game");
    const ctx = canvas.getContext("2d");

    const scoreEl = $("score");
    const bestEl  = $("best");
    const speedEl = $("speed");

    const startBtn = $("startBtn");
    const pauseBtn = $("pauseBtn");
    const hardBtn  = $("hardBtn");

    const rageBar = $("rageBar");
    const rageLabel = $("rageLabel");
    let rage = 5; // 0..100

    function setRage(n){
      rage = Math.max(0, Math.min(100, n));
      rageBar.style.width = rage + "%";
      rageLabel.textContent =
        rage < 15 ? "Calm-ish." :
        rage < 35 ? "Mildly annoyed (Irish queue energy)." :
        rage < 60 ? "Spicy frustration." :
        rage < 85 ? "Keyboard looking throwable." :
        "Full gamer rage. Drink water.";
    }
    setRage(rage);
    setInterval(()=> setRage(rage - 1), 3500);

    const GRID = 24;
    const COLS = Math.floor(canvas.width / GRID);
    const ROWS = Math.floor(canvas.height / GRID);

    const STORAGE_KEY = "raheem_snake_best";
    let best = Number(localStorage.getItem(STORAGE_KEY) || 0);
    bestEl.textContent = best;

    let snake, dir, nextDir, food, score, running, paused, tickMs, hardMode;

    // Colors (so it‚Äôs not black-on-black)
    const COLORS = {
      grid: "rgba(255,255,255,0.10)",
      boardA: "rgba(255,255,255,0.06)",
      boardB: "rgba(0,0,0,0.10)",
      snakeHead: "rgba(34,197,94,0.95)",   // green
      snakeBody: "rgba(59,130,246,0.90)",   // blue
      food: "rgba(248,113,113,0.95)",       // red
      text: "white",
      overlay: "rgba(0,0,0,0.55)"
   a
    };

    function resetGame(){
      snake = [{x: Math.floor(COLS/2), y: Math.floor(ROWS/2)}];
      dir = {x: 1, y: 0};
      nextDir = {x: 1, y: 0};
      score = 0;
      running = true;
      paused = false;
      tickMs = hardMode ? 85 : 120;
      placeFood();
      scoreEl.textContent = score;
      updateSpeedLabel();
      addLog(hardMode ? "Hard mode enabled. Reflexes required." : "Snake restarted. Productivity paused.", "ok");
    }

    function updateSpeedLabel(){
      const base = 120;
      const mult = (base / tickMs);
      speedEl.textContent = mult.toFixed(1) + "x";
    }

    function placeFood(){
      while(true){
        const fx = Math.floor(Math.random()*COLS);
        const fy = Math.floor(Math.random()*ROWS);
        if(!snake.some(s=>s.x===fx && s.y===fy)){
          food = {x: fx, y: fy};
          return;
        }
      }
    }

    function overlayText(big, small){
      ctx.save();
      ctx.fillStyle = COLORS.overlay;
      ctx.fillRect(0,0,canvas.width,canvas.height);
      ctx.fillStyle = COLORS.text;
      ctx.font = "900 42px system-ui, sans-serif";
      ctx.textAlign = "center";
      ctx.fillText(big, canvas.width/2, canvas.height/2 - 10);
      ctx.font = "500 16px system-ui, sans-serif";
      ctx.fillText(small, canvas.width/2, canvas.height/2 + 24);
      ctx.restore();
    }

    function draw(){
      // board background
      ctx.clearRect(0,0,canvas.width,canvas.height);
      const g = ctx.createLinearGradient(0,0,0,canvas.height);
      g.addColorStop(0, COLORS.boardA);
      g.addColorStop(1, COLORS.boardB);
      ctx.fillStyle = g;
      ctx.fillRect(0,0,canvas.width,canvas.height);

      // grid
      ctx.strokeStyle = COLORS.grid;
      ctx.globalAlpha = 1;
      for(let x=0;x<=COLS;x++){
        ctx.beginPath(); ctx.moveTo(x*GRID,0); ctx.lineTo(x*GRID,canvas.height); ctx.stroke();
      }
      for(let y=0;y<=ROWS;y++){
        ctx.beginPath(); ctx.moveTo(0,y*GRID); ctx.lineTo(canvas.width,y*GRID); ctx.stroke();
      }

      // food
      ctx.fillStyle = COLORS.food;
      ctx.fillRect(food.x*GRID+4, food.y*GRID+4, GRID-8, GRID-8);

      // snake
      snake.forEach((s,i)=>{
        const pad = i===0 ? 3 : 5;
        ctx.fillStyle = i===0 ? COLORS.snakeHead : COLORS.snakeBody;
        ctx.fillRect(s.x*GRID+pad, s.y*GRID+pad, GRID-(pad*2), GRID-(pad*2));
      });

      if(!running){
        overlayText("Game over üíÄ", "Press Start / Restart");
      } else if(paused){
        overlayText("Paused ‚è∏", "Press P or Pause");
      }
    }

    function step(){
      if(!running || paused) return;

      dir = nextDir;
      const head = snake[0];
      const newHead = {x: head.x + dir.x, y: head.y + dir.y};

      if(newHead.x < 0 || newHead.x >= COLS || newHead.y < 0 || newHead.y >= ROWS){
        die("Snake tried to leave. Same, honestly.");
        return;
      }

      if(snake.some(s => s.x === newHead.x && s.y === newHead.y)){
        die("Snake got philosophical and ate itself.");
        return;
      }

      snake.unshift(newHead);

      if(newHead.x === food.x && newHead.y === food.y){
        score++;
        scoreEl.textContent = score;

        if(score % 4 === 0){
          tickMs = Math.max(55, tickMs - (hardMode ? 6 : 4));
          updateSpeedLabel();
        }

        if(score > best){
          best = score;
          localStorage.setItem(STORAGE_KEY, String(best));
          bestEl.textContent = best;
        }

        placeFood();
        addLog(randomPick([
          "Snack acquired. TGDs approved. Server still crying.",
          "Apple defeated. Planning regs remain undefeated.",
          "Crunchy pixels consumed successfully.",
          "Raheem AI applauds. The server does not."
        ]), "ok");
      } else {
        snake.pop();
      }
    }

    function die(message){
      running = false;
      setRage(rage + 18);
      addLog(message, "nope");
      addLog("Maintenance tip: blame ‚Äòcompliance‚Äô and walk away confidently.", "warn");
    }

    function setDirection(x,y){
      if((dir.x === 1 && x === -1) || (dir.x === -1 && x === 1) ||
         (dir.y === 1 && y === -1) || (dir.y === -1 && y === 1)) return;
      nextDir = {x,y};
    }

    window.addEventListener("keydown", (e)=>{
      const k = e.key.toLowerCase();
      if(k === "arrowup" || k === "w") setDirection(0,-1);
      if(k === "arrowdown" || k === "s") setDirection(0,1);
      if(k === "arrowleft" || k === "a") setDirection(-1,0);
      if(k === "arrowright" || k === "d") setDirection(1,0);
      if(k === "p") togglePause();
      if(k === "escape" && overlay.classList.contains("show")) closePanic();
    });

    function togglePause(){
      if(!running) return;
      paused = !paused;
      addLog(paused ? "Paused. Pretend you‚Äôre doing planning research." : "Unpaused. Back to snake business.", paused ? "warn" : "ok");
      draw();
    }

    startBtn.addEventListener("click", ()=>{ resetGame(); draw(); });
    pauseBtn.addEventListener("click", togglePause);

    hardBtn.addEventListener("click", ()=>{
      hardMode = !hardMode;
      hardBtn.classList.toggle("primary", hardMode);
      resetGame(); draw();
    });

    hardMode = false;
    resetGame(); draw();

    let last = performance.now();
    function loop(now){
      const elapsed = now - last;
      if(elapsed >= tickMs){
        last = now;
        step();
        draw();
      }
      requestAnimationFrame(loop);
    }
    requestAnimationFrame(loop);
  </script>
</body>
</html>
